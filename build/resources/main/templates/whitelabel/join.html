<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/html">

<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhiteLabel</title>


    <!-- Bootstrap CSS -->
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous">

    <style>
        label {
            color: darkgray;
        }

        .dark-mode {
            background-color: #2a2a2a;
            color: white;
        }

        button {
            background-color: #212529;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
        }

        button:hover {
            background-color: #343a40;
        }

        body {
            min-height: 100vh;
            background: -webkit-gradient(linear, left bottom, right top, from(#4c5053));
            background: -webkit-linear-gradient(bottom left, #4c5053 0%, #4c5053 100%);
            background: -moz-linear-gradient(bottom left, #4c5053 0%, #4c5053 100%);
            background: -o-linear-gradient(bottom left, #4c5053 0%, #4c5053 100%);
            background: linear-gradient(to top right, #4c5053 0%, #4c5053 100%);
        }

        .input-form {
            max-width: 680px;
            margin-top: 80px;
            padding: 32px;
            background: #fff;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            -webkit-box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
            -moz-box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
            box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15)
        }
    </style>

</head>

<body>


<input type="hidden" id="encPswd" name="encPswd" value="">
<div class="container" style="background-color: #4c5053">
    <div class="input-form-backgroud row">

        <div class="input-form col-md-12 mx-auto">
            <a href="/" class="navbar-brand d-flex align-items-center">
                <strong>WhiteLabelSurvey</strong>
            </a>
            <h4 style="color: #4c5053;" class="mb-3">회원가입</h4>
            <form action="/whitelabel/join" method="post"
                  class="validation-form">
                <input type="hidden" name="csrf" value="{{csrf.token}}">
                <div class="form-group">
                    <div class="form-group">
                        <label for="loginId">Id를 입력해주세요.</label>
                        <input type="text"
                               id="loginId" name="loginId" class="form-control" style="margin-bottom: 3px"
                               placeholder="아이디를 입력해주세요." required>
                        <button type="button" id="checkId" name="checkId" class="btn btn-primary btn-sm btn-block">
                            중복확인
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">비밀번호</label> <input type="password"
                                                              class="form-control" id="password" name="password"
                                                              placeholder="비밀번호를 입력해주세요" required>
                </div>
                <div class="form-group">
                    <label for="inputPasswordCheck">비밀번호 확인</label> <input
                        type="password" class="form-control" id="inputPasswordCheck"
                        name="inputPasswordCheck" placeholder="비밀번호 확인" required>
                </div>

                <div class="alert alert-success" id="alert-success">비밀번호가 일치합니다.</div>
                <div class="alert alert-danger" id="alert-danger">비밀번호가 일치하지 않습니다.</div>


                <div class="form-group">
                    <label for="name">성명</label> <input type="text"
                                                        class="form-control" id="name" name="name"
                                                        placeholder="이름을 입력해 주세요" required>
                </div>
                <div class="form-group">
                    <label for="email">이메일 주소</label> <input type="email"
                                                             class="form-control" id="email" name="email"
                                                             style="margin-bottom: 3px"
                                                             placeholder="이메일을 입력해 주세요." required>
                    <button type="button" id="sendEmailNB" name="sendEmailNB" class="btn btn-primary btn-sm btn-block">
                        인증번호 발송
                    </button>
                </div>

                <div class="form-group">
                    <label for="checkEmailNB">이메일 인증번호</label> <input type="text"
                                                                      class="form-control" id="checkEmailNB"
                                                                      name="checkEmailNB" style="margin-bottom: 3px"
                                                                      placeholder="이메일로 수신하신 인증번호를 넣어주세요." required>
                    <button type="button" id="checkEmailNBFine" name="checkEmailNBFine"
                            class="btn btn-primary btn-sm btn-block">인증 확인
                    </button>
                </div>


                <div class="form-group">
                    <label for="phone">휴대폰 번호</label> <input type="tel"
                                                             class="form-control" id="phone" name="phone"
                                                             placeholder="휴대폰번호를 입력해 주세요" required>
                </div>

                <div class="mb-3">
                    <label for="addr">주소</label> <input type="text"
                                                        class="form-control" id="addr" name="addr"
                                                        placeholder="ex)서울특별시 강남구" required>
                    <div class="invalid-feedback">주소를 입력해주세요.</div>
                </div>

                <div class="mb-3">
                    <label for="detailaddr">상세주소<span class="text-muted">&nbsp;(필수
								아님)</span></label> <input type="text" class="form-control" id="detailaddr"
                                                          name="detailaddr" placeholder="상세주소를 입력해주세요.">
                </div>

                <hr class="mb-4">
                <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="aggrement"
                           name="aggrement" required> <label
                        class="custom-control-label" for="aggrement">개인정보 수집 및
                    이용에 동의합니다.</label>
                </div>
                <div class="mb-4"></div>
                <button class="btn btn-primary btn-lg btn-block" name="joinFine" id="joinFine" type="submit">가입
                    완료
                </button>
            </form>
            <script>
                var passwordInput = $('input[type=password]');
                var checkId = $("#checkId");
                var sendEmailNB = $("#sendEmailNB");
                var checkEmailNB = $("#checkEmailNBFine");
                var passwordOk = $("#alert-success");
                var passwordNo = $("#alert-danger");

                passwordOk.hide();
                passwordNo.hide();

                $(passwordInput).keyup(function () {
                    var pwd1 = $("#password").val();
                    var pwd2 = $("#inputPasswordCheck").val();
                    if (pwd1 !== "" || pwd2 !== "") {
                        if (pwd1 !== pwd2) {
                            passwordOk.hide();
                            passwordNo.show();
                        } else if (pwd1 === pwd2) {
                            passwordOk.show();
                            passwordNo.hide();
                        }
                    }
                })

                $(checkId).click(function () {
                    var loginId = $('#loginId').val();
                    $.ajax({
                        url: '/whitelabel/checkId',
                        type: 'GET',
                        data: {
                            id: loginId
                        },
                        success: function (data) {
                            if (loginId === "") {
                                alert('사용하실 ID를 입력해 주세요.')
                            } else if (data === true) {
                                alert('중복되거나 사용할 수 없는 ID입니다.');
                            } else {
                                alert('사용 가능한 ID입니다.');
                            }
                        },
                        error: function () {
                            alert('ID 중복검사중 오류가 발생하였습니다. 다시 시도 해주세요.');
                            return false;
                        }
                    });
                });


                $(sendEmailNB).click(function () {
                    var email = $('#email').val();

                    $.ajax({
                        url: '/whitelabel/sendEmailCheck',
                        type: 'POST',
                        data: {
                            email: email
                        },
                        success: function (data) {

                            if (email === "") {
                                alert('Email을 입력해 주세요.')
                            } else if (data === false) {
                                alert('인증번호 발송중 오류가 발생하였습니다. 다시 시도 해주세요.')
                            } else {
                                alert('이메일로 인증번호를 발송하였습니다.')
                            }
                        },
                        error: function () {
                            alert('인증번호 발송중 오류가 발생하였습니다. 다시 시도 해주세요.')
                            return false;
                        }
                    })
                });
                $(checkEmailNB).click(function () {
                    var emailNB = $('#checkEmailNB').val();
                    $.ajax({
                        url: '/whitelabel/checkEmailNBFine',
                        type: 'POST',
                        data: {
                            emailNB: emailNB
                        },
                        success: function (data) {

                            if (emailNB === "") {
                                alert('인증번호를 입력하여 주세요.')
                            } else if (data === false) {
                                alert('인증번호가 틀리거나, 입력이 잘못되었습니다.')
                            } else {
                                alert('인증이 완료 되었습니다.')
                            }
                        }
                    })
                })

            </script>
        </div>
    </div>
</div>

</body>

</html>